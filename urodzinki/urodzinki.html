<!DOCTYPE html>
<html lang="pl">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Wszystkiego najlepszego z okazji urodzin, Nisia!</title>
 <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600;700&family=Dancing+Script:wght@400..700&display=swap" rel="stylesheet">
 <style>
  * {
   margin: 0;
   padding: 0;
   box-sizing: border-box;
  }

  html, body {
   width: 100%;
   font-family: 'Poppins', sans-serif;
   background: #000;
   overflow-x: hidden;
  }

  .section {
   min-height: 100vh;
   width: 100%;
   display: flex;
   justify-content: center;
   align-items: center;
   padding: 40px 20px;
   scroll-behavior: smooth;
  }

  /* SECTION 1 - BIRTHDAY */
  .section-birthday {
   background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .birthday-content {
   background: white;
   border-radius: 20px;
   box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
   max-width: 600px;
   width: 100%;
   padding: 50px 40px;
   text-align: center;
   animation: slideIn 0.8s ease-out;
  }

  .birthday-content h1 {
   font-family: 'Great Vibes', cursive;
   font-size: 3.5rem;
   color: #764ba2;
   margin-bottom: 20px;
   text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
  }

  .birthday-content .subtitle {
   font-size: 1.3rem;
   color: #667eea;
   font-weight: 600;
   margin-bottom: 30px;
  }

  .birthday-content .message {
   font-size: 1.1rem;
   color: #555;
   line-height: 1.8;
   margin-bottom: 30px;
  }

  .birthday-content img {
   width: 100%;
   height: auto;
   border-radius: 15px;
   margin: 30px 0;
   box-shadow: 0 10px 30px rgba(118, 75, 162, 0.2);
   transition: transform 0.3s ease;
  }

  .birthday-content img:hover {
   transform: scale(1.02);
  }

  .birthday-content .closing {
   font-size: 1.1rem;
   color: #555;
   line-height: 1.8;
   margin-top: 30px;
  }

  .birthday-content .hearts {
   font-size: 2rem;
   margin: 20px 0;
  }

  /* SECTION 2 - HEARTBEAT */
  .section-heartbeat {
   background: linear-gradient(135deg, #f5f5f5 0%, #fff 100%);
   position: relative;
   overflow: hidden;
  }

  .heartbeat-container {
   position: relative;
   width: 100%;
   max-width: 400px;
   height: 400px;
  }

  .heartbeat-title {
   position: absolute;
   z-index: 100;
   top: 10%;
   left: 50%;
   transform: translateX(-50%);
   font-size: 1.8rem;
   font-weight: 600;
   color: #764ba2;
   text-align: center;
   width: 90%;
  }

  .back {
   position: absolute;
   width: 250px;
   height: 250px;
   top: 50%;
   left: 50%;
   transform: translate(-50%, -50%);
   animation-name: back;
   animation-duration: 3s;
   animation-iteration-count: infinite;
   border-radius: 50%;
  }

  .love {
   position: absolute;
   background-color: rgb(207, 105, 112);
   width: 150px;
   height: 150px;
   top: 50%;
   left: 50%;
   transform: translate(-50%, -50%) rotate(-45deg);
   animation-name: love;
   animation-duration: 3s;
   animation-delay: 1s;
   animation-iteration-count: infinite;
   z-index: 2;
  }

  .love::before {
   content: "";
   position: absolute;
   background-color: rgb(207, 105, 112);
   border-radius: 50%;
   width: 150px;
   height: 150px;
   top: -75px;
   left: 0px;
  }

  .love::after {
   content: "";
   position: absolute;
   background-color: rgb(207, 105, 112);
   border-radius: 50%;
   width: 150px;
   height: 150px;
   left: 75px;
   top: 0px;
  }

  .love-1 {
   position: absolute;
   background-color: rgb(231, 132, 139);
   width: 80px;
   height: 80px;
   top: 50%;
   left: 50%;
   transform: translate(-50%, -50%) rotate(-45deg);
   animation-name: love-1;
   animation-duration: 2s;
   animation-delay: 1.7s;
   animation-iteration-count: infinite;
   z-index: 2;
  }

  .love-1::before {
   content: "";
   position: absolute;
   background-color: rgb(231, 132, 139);
   border-radius: 50%;
   width: 80px;
   height: 80px;
   top: -40px;
   left: 0px;
  }

  .love-1::after {
   content: "";
   position: absolute;
   background-color: rgb(231, 132, 139);
   border-radius: 50%;
   width: 80px;
   height: 80px;
   left: 40px;
   top: 0px;
  }

  .love-2 {
   position: absolute;
   background-color: pink;
   width: 40px;
   height: 40px;
   top: 50%;
   left: 50%;
   transform: translate(-50%, -50%) rotate(-45deg);
   animation-name: love-2;
   animation-duration: 1s;
   animation-delay: 1s;
   animation-iteration-count: infinite;
   z-index: 2;
  }

  .love-2::before {
   content: "";
   position: absolute;
   background-color: pink;
   border-radius: 50%;
   width: 40px;
   height: 40px;
   top: -20px;
   left: 0px;
  }

  .love-2::after {
   content: "";
   position: absolute;
   background-color: pink;
   border-radius: 50%;
   width: 40px;
   height: 40px;
   left: 20px;
   top: 0px;
  }

  @keyframes back {
   50% { background: rgb(250, 211, 214); }
  }

  @keyframes love {
   50% { transform: translate(-50%, -50%) scale(0.3) rotate(-45deg); }
  }

  @keyframes love-1 {
   50% { transform: translate(-50%, -50%) scale(0.5) rotate(-45deg); }
  }

  @keyframes love-2 {
   50% { transform: translate(-50%, -50%) scale(1.25) rotate(-45deg); }
  }

  /* SECTION 3 - LETTER */
  .section-letter {
   background-color: #f0e6f6;
   flex-direction: column;
  }

  .letter-wrapper {
   display: flex;
   flex-direction: column;
   align-items: center;
   gap: 30px;
  }

  #envelope {
   position: relative;
   width: 280px;
   height: 180px;
   border-bottom-left-radius: 6px;
   border-bottom-right-radius: 6px;
   background-color: #d9534f;
   box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
   cursor: pointer;
  }

  .front {
   position: absolute;
   width: 0;
   height: 0;
   z-index: 3;
  }

  .flap {
   border-left: 140px solid transparent;
   border-right: 140px solid transparent;
   border-bottom: 82px solid transparent;
   border-top: 98px solid #d9534f;
   transform-origin: top;
   pointer-events: none;
  }

  .pocket {
   border-left: 140px solid #f5a3a2;
   border-right: 140px solid #f5a3a2;
   border-bottom: 90px solid #ff6f61;
   border-top: 90px solid transparent;
   border-bottom-left-radius: 6px;
   border-bottom-right-radius: 6px;
  }

  .letter {
   position: relative;
   background-color: #fff;
   width: 90%;
   margin-left: auto;
   margin-right: auto;
   height: 90%;
   top: 5%;
   border-radius: 6px;
   box-shadow: 0 2px 26px rgba(0, 0, 0, 0.12);
   font-family: "Dancing Script", cursive;
   display: flex;
   flex-direction: column;
   justify-content: center;
   align-items: center;
  }

  .words {
   font-size: 1rem;
   text-align: center;
   color: #333;
   margin: 8px 0;
   font-weight: 500;
  }

  .open .flap {
   transform: rotateX(180deg);
   transition: transform 0.4s ease, z-index 0.6s;
   z-index: 1;
  }

  .close .flap {
   transform: rotateX(0deg);
   transition: transform 0.4s 0.6s ease, z-index 1s;
   z-index: 5;
  }

  .close .letter {
   transform: translateY(0px);
   transition: transform 0.4s ease, z-index 1s;
   z-index: 1;
   opacity: 0;
  }

  .open .letter {
   transform: translateY(-100px);
   transition: transform 0.4s 0.6s ease, z-index 0.6s;
   z-index: 2;
   opacity: 1;
  }

  .hearts-letter {
   position: absolute;
   top: 90px;
   left: 0;
   right: 0;
   z-index: 2;
  }

  .heart {
   position: absolute;
   bottom: 0;
   right: 10%;
   pointer-events: none;
  }

  .heart:before,
  .heart:after {
   position: absolute;
   content: "";
   left: 50px;
   top: 0;
   width: 50px;
   height: 80px;
   background: #e60073;
   border-radius: 50px 50px 0 0;
   transform: rotate(-45deg);
   transform-origin: 0 100%;
   pointer-events: none;
  }

  .heart:after {
   left: 0;
   transform: rotate(45deg);
   transform-origin: 100% 100%;
  }

  .close .heart {
   opacity: 0;
   animation: none;
  }

  .a1 {
   left: 20%;
   transform: scale(0.6);
   opacity: 1;
   animation: slideUp 4s linear 1, sideSway 2s ease-in-out 4 alternate;
   animation-fill-mode: forwards;
   animation-delay: 0.7s;
  }

  .a2 {
   left: 55%;
   transform: scale(1);
   opacity: 1;
   animation: slideUp 5s linear 1, sideSway 4s ease-in-out 2 alternate;
   animation-fill-mode: forwards;
   animation-delay: 0.7s;
  }

  .a3 {
   left: 10%;
   transform: scale(0.8);
   opacity: 1;
   animation: slideUp 7s linear 1, sideSway 2s ease-in-out 6 alternate;
   animation-fill-mode: forwards;
   animation-delay: 0.7s;
  }

  @keyframes slideUp {
   0% { top: 0; }
   100% { top: -600px; }
  }

  @keyframes sideSway {
   0% { margin-left: 0px; }
   100% { margin-left: 50px; }
  }

  .reset {
   text-align: center;
  }

  .reset button {
   font-weight: 800;
   font-style: normal;
   transition: all 0.2s linear;
   -webkit-appearance: none;
   background-color: transparent;
   border: solid 2px #d9534f;
   border-radius: 4px;
   color: #d9534f;
   display: inline-block;
   font-size: 14px;
   text-transform: uppercase;
   margin: 5px;
   padding: 10px 20px;
   line-height: 1em;
   text-decoration: none;
   min-width: 120px;
   cursor: pointer;
  }

  .reset button:hover {
   background-color: #d9534f;
   color: #fff;
   transform: scale(1.05);
  }

  /* SECTION 4 - NIGHT & FLOWER */
  .section-night {
   background: #000;
   position: relative;
  }

  .night-scene {
   position: relative;
   width: 100%;
   max-width: 400px;
   height: 400px;
  }

  .circle-container {
   width: 100%;
   height: 100%;
   background: linear-gradient(to bottom, #020107 0%, #201b46 40%);
   overflow: hidden;
   border-radius: 50%;
   position: relative;
   box-shadow: 0 0 50px rgba(100, 50, 150, 0.5);
  }

  .blade {
   position: absolute;
   border-radius: 50% 50% 0 0;
  }

  .bg-blade { background: #01636f; z-index: 2; }
  .mid-blade { background: #3295ac; z-index: 3; }
  .fg-blade { background: #203a43; z-index: 4; }

  .stars {
   position: absolute;
   border-radius: 50%;
   background: white;
   box-shadow: 0 0 3px white;
  }

  .glass-vase {
   position: absolute;
   bottom: 15%;
   left: 50%;
   transform: translateX(-50%);
   z-index: 10;
   width: 35px;
   height: 100px;
   background: rgba(255, 255, 255, 0.1);
   border-radius: 0 0 12px 12px;
   box-shadow: inset -2px 0 5px rgba(255, 255, 255, 0.3);
  }

  .shine {
   position: absolute;
   width: 6px;
   height: 50px;
   background: rgba(255, 255, 255, 0.4);
   border-radius: 50%;
   left: 6px;
   top: 10px;
  }

  .flower {
   position: absolute;
   bottom: 20%;
   left: 50%;
   transform: translateX(-50%);
   z-index: 11;
  }

  .petal {
   position: absolute;
   width: 20px;
   height: 40px;
   background: #ff1493;
   border-radius: 50% 50% 50% 0;
   left: 50%;
   top: 0;
   transform-origin: 50% 100%;
   animation: bloomSway 3s ease-in-out infinite;
  }

  .petal:nth-child(1) { animation-delay: 0s; }
  .petal:nth-child(2) { animation-delay: 0.2s; }
  .petal:nth-child(3) { animation-delay: 0.4s; }
  .petal:nth-child(4) { animation-delay: 0.6s; }
  .petal:nth-child(5) { animation-delay: 0.8s; }
  .petal:nth-child(6) { animation-delay: 1s; }
  .petal:nth-child(7) { animation-delay: 1.2s; }

  /* SECTION 5 - CANVAS HEART */
  .section-canvas {
   background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(50,50,100,0.7) 100%);
   padding: 0;
  }

  canvas {
   display: block;
   width: 100%;
   height: 100vh;
  }

  /* ANIMATIONS */
  @keyframes slideIn {
   from { opacity: 0; transform: translateY(30px); }
   to { opacity: 1; transform: translateY(0); }
  }

  @keyframes bloomSway {
   0% { 
    transform: translateY(0px) scaleY(0.8) rotateZ(0deg);
    opacity: 0.6;
   }
   50% {
    transform: translateY(-5px) scaleY(1) rotateZ(5deg);
    opacity: 1;
   }
   100% {
    transform: translateY(0px) scaleY(0.8) rotateZ(0deg);
    opacity: 0.6;
   }
  }

  /* MOBILE RESPONSIVE */
  @media (max-width: 768px) {
   .section {
    padding: 30px 15px;
    min-height: auto;
   }

   .birthday-content {
    padding: 30px 20px;
   }

   .birthday-content h1 {
    font-size: 2rem;
   }

   .birthday-content .subtitle {
    font-size: 1rem;
   }

   .birthday-content .message,
   .birthday-content .closing {
    font-size: 0.9rem;
    line-height: 1.6;
   }

   .birthday-content img {
    margin: 20px 0;
    border-radius: 10px;
   }

   .heartbeat-container {
    height: 300px;
    max-width: 300px;
   }

   .heartbeat-title {
    font-size: 1.3rem;
    top: 5%;
   }

   .back {
    width: 180px;
    height: 180px;
   }

   .love {
    width: 120px;
    height: 120px;
   }

   .love::before, .love::after {
    width: 120px;
    height: 120px;
   }

   .love::before { top: -60px; }
   .love::after { left: 60px; }

   .love-1 {
    width: 60px;
    height: 60px;
   }

   .love-1::before, .love-1::after {
    width: 60px;
    height: 60px;
   }

   .love-1::before { top: -30px; }
   .love-1::after { left: 30px; }

   .love-2 {
    width: 30px;
    height: 30px;
   }

   .love-2::before, .love-2::after {
    width: 30px;
    height: 30px;
   }

   .love-2::before { top: -15px; }
   .love-2::after { left: 15px; }

   #envelope {
    width: 220px;
    height: 140px;
   }

   .flap {
    border-left: 110px solid transparent;
    border-right: 110px solid transparent;
    border-bottom: 65px solid transparent;
    border-top: 75px solid #d9534f;
   }

   .pocket {
    border-left: 110px solid #f5a3a2;
    border-right: 110px solid #f5a3a2;
    border-bottom: 72px solid #ff6f61;
    border-top: 72px solid transparent;
   }

   .words {
    font-size: 0.85rem;
   }

   .heart:before, .heart:after {
    width: 35px;
    height: 60px;
    left: 35px;
   }

   .heart:after {
    left: 0;
   }

   .night-scene {
    height: 300px;
    max-width: 300px;
   }

   .circle-container {
    box-shadow: 0 0 30px rgba(100, 50, 150, 0.4);
   }

   canvas {
    height: auto;
   }

   .glass-vase {
    width: 28px;
    height: 80px;
   }

   .petal {
    width: 16px;
    height: 32px;
   }
  }

  @media (max-width: 480px) {
   .section {
    padding: 20px 10px;
   }

   .birthday-content {
    padding: 20px 15px;
    border-radius: 15px;
   }

   .birthday-content h1 {
    font-size: 1.5rem;
    margin-bottom: 15px;
   }

   .birthday-content .subtitle {
    font-size: 0.9rem;
    margin-bottom: 15px;
   }

   .birthday-content .message,
   .birthday-content .closing {
    font-size: 0.85rem;
   }

   .birthday-content img {
    margin: 15px 0;
    border-radius: 8px;
   }

   .birthday-content .hearts {
    font-size: 1.5rem;
    margin: 15px 0;
   }

   .heartbeat-container {
    height: 250px;
    max-width: 250px;
   }

   .heartbeat-title {
    font-size: 1rem;
    top: 5%;
    width: 95%;
   }

   .back {
    width: 140px;
    height: 140px;
   }

   .love {
    width: 90px;
    height: 90px;
   }

   .love::before, .love::after {
    width: 90px;
    height: 90px;
   }

   .love::before { top: -45px; }
   .love::after { left: 45px; }

   .love-1 {
    width: 45px;
    height: 45px;
   }

   .love-1::before, .love-1::after {
    width: 45px;
    height: 45px;
   }

   .love-1::before { top: -22.5px; }
   .love-1::after { left: 22.5px; }

   .love-2 {
    width: 22px;
    height: 22px;
   }

   .love-2::before, .love-2::after {
    width: 22px;
    height: 22px;
   }

   .love-2::before { top: -11px; }
   .love-2::after { left: 11px; }

   #envelope {
    width: 180px;
    height: 115px;
   }

   .flap {
    border-left: 90px solid transparent;
    border-right: 90px solid transparent;
    border-bottom: 53px solid transparent;
    border-top: 62px solid #d9534f;
   }

   .pocket {
    border-left: 90px solid #f5a3a2;
    border-right: 90px solid #f5a3a2;
    border-bottom: 58px solid #ff6f61;
    border-top: 58px solid transparent;
   }

   .words {
    font-size: 0.75rem;
    margin: 4px 0;
   }

   .reset button {
    font-size: 11px;
    padding: 8px 12px;
    min-width: 90px;
    margin: 4px;
   }

   .heart:before, .heart:after {
    width: 25px;
    height: 45px;
    left: 25px;
   }

   .heart:after {
    left: 0;
   }

   .night-scene {
    height: 250px;
    max-width: 250px;
   }

   .glass-vase {
    width: 25px;
    height: 70px;
    bottom: 20%;
   }

   .shine {
    width: 5px;
    height: 40px;
    left: 5px;
    top: 8px;
   }

   .petal {
    width: 14px;
    height: 28px;
   }

   canvas {
    height: 100vh;
   }
  }
#footer {
    position: absolute;
    bottom: 0;
    right: 0;
    left: 0;
    background-color: #f8f9fa;
    padding: 10px;
    text-align: center;
}
 </style>
</head>
<body>

 <!-- SECTION 1 - BIRTHDAY GREETING -->
 <div class="section section-birthday">
  <div class="birthday-content">
   <h1>Wszystkiego najlepszego!</h1>
   <div class="subtitle">üéâ Nisia üéâ</div>
   <p class="message">Twoje urodziny sƒÖ specjalnym dniem! Chcia≈Çem zrobiƒá aby ten dzie≈Ñ by≈Ç specjalny, tylko dla Ciebie.</p>
   <img src="lovyou.gif" alt="Wszystkiego najlepszego z okazji urodzin">
   <p class="closing">Dzie≈Ñ ten jest tak samo wyjƒÖtkowy jak ty kochanie!</p>
   <div class="hearts">üíï ‚ú® üíï</div>
  </div>
 </div>

 <!-- SECTION 2 - HEARTBEAT ANIMATION -->
 <div class="section section-heartbeat">
  <div class="heartbeat-container">
   <div class="heartbeat-title">Moje serce bije tylko dla ciebie! ‚ù§Ô∏è</div>
   <div class="back"></div>
   <div class="love"></div>
   <div class="love-1"></div>
   <div class="love-2"></div>
  </div>
 </div>

 <!-- SECTION 3 - LOVE LETTER -->
 <div class="section section-letter">
  <div class="letter-wrapper">
   <div id="envelope" class="close">
    <div class="front flap"></div>
    <div class="front pocket"></div>
    <div class="letter">
     <div class="words">Dla: Nisia ‚ù§Ô∏è</div>
     <div class="words">Jeste≈õ cudowna!</div>
     <div class="words">Jeste≈õ najpiƒôkniejszƒÖ na ≈õwiecie!</div>
     <div class="words">Moje serce bije dla ciebie ‚ù§Ô∏è</div>
    </div>
    <div class="hearts-letter">
     <div class="heart a1"></div>
     <div class="heart a2"></div>
     <div class="heart a3"></div>
    </div>
   </div>
   <div class="reset">
    <button id="open">Otw√≥rz</button>
    <button id="reset">Zamknij</button>
   </div>
  </div>
 </div>


 <!-- SECTION 5 - CANVAS HEART -->
 <div class="section section-canvas">
  <canvas id="heart"></canvas>
 </div>

 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
 <script>
  $(document).ready(function () {
   var envelope = $("#envelope");
   var btn_open = $("#open");
   var btn_reset = $("#reset");

   envelope.click(function () {
    open();
   });
   btn_open.click(function () {
    open();
   });
   btn_reset.click(function () {
    close();
   });

   function open() {
    envelope.addClass("open").removeClass("close");
   }
   function close() {
    envelope.addClass("close").removeClass("open");
   }
  });

  window.requestAnimationFrame = window.__requestAnimationFrame || window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || (function () {
   return function (callback, element) {
    let lastTime = element.__lastTime;
    if (lastTime === undefined) lastTime = 0;
    let currTime = Date.now();
    let timeToCall = Math.max(1, 33 - (currTime - lastTime));
    window.setTimeout(callback, timeToCall);
    element.__lastTime = currTime + timeToCall;
   };
  })();

  window.isDevice = (/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(((navigator.userAgent || navigator.vendor || window.opera)).toLowerCase()));
  let loaded = false;
  let init = function () {
   if (loaded) return;
   loaded = true;
   let mobile = window.isDevice;
   let koef = mobile ? 0.5 : 1;
   let canvas = document.getElementById('heart');
   if (!canvas) return;
   let ctx = canvas.getContext('2d');
   let width = canvas.width = koef * innerWidth;
   let height = canvas.height = koef * innerHeight;
   let rand = Math.random;
   ctx.fillStyle = "rgba(0,0,0,1)";
   ctx.fillRect(0, 0, width, height);

   let heartPosition = function (rad) {
    return [Math.pow(Math.sin(rad), 3), -(15 * Math.cos(rad) - 5 * Math.cos(2 * rad) - 2 * Math.cos(3 * rad) - Math.cos(4 * rad))];
   };
   let scaleAndTranslate = function (pos, sx, sy, dx, dy) {
    return [dx + pos[0] * sx, dy + pos[1] * sy];
   };

   window.addEventListener('resize', function () {
    width = canvas.width = koef * innerWidth;
    height = canvas.height = koef * innerHeight;
    ctx.fillStyle = "rgba(0,0,0,1)";
    ctx.fillRect(0, 0, width, height);
   });

   let traceCount = mobile ? 20 : 50;
   let pointsOrigin = [];
   let i;
   let dr = mobile ? 0.3 : 0.1;
   for (i = 0; i < Math.PI * 2; i += dr) pointsOrigin.push(scaleAndTranslate(heartPosition(i), 210, 13, 0, 0));
   for (i = 0; i < Math.PI * 2; i += dr) pointsOrigin.push(scaleAndTranslate(heartPosition(i), 150, 9, 0, 0));
   for (i = 0; i < Math.PI * 2; i += dr) pointsOrigin.push(scaleAndTranslate(heartPosition(i), 90, 5, 0, 0));
   let heartPointsCount = pointsOrigin.length;

   let targetPoints = [];
   let pulse = function (kx, ky) {
    for (i = 0; i < pointsOrigin.length; i++) {
     targetPoints[i] = [];
     targetPoints[i][0] = kx * pointsOrigin[i][0] + width / 2;
     targetPoints[i][1] = ky * pointsOrigin[i][1] + height / 2;
    }
   };

   let e = [];
   for (i = 0; i < heartPointsCount; i++) {
    let x = rand() * width;
    let y = rand() * height;
    e[i] = {
     vx: 0,
     vy: 0,
     R: 2,
     speed: rand() + 5,
     q: ~~(rand() * heartPointsCount),
     D: 2 * (i % 2) - 1,
     force: 0.2 * rand() + 0.7,
     f: "hsla(0," + ~~(40 * rand() + 60) + "%," + ~~(60 * rand() + 20) + "%,.3)",
     trace: []
    };
    for (let k = 0; k < traceCount; k++) e[i].trace[k] = { x: x, y: y };
   }
   let config = {
    traceK: 0.4,
    timeDelta: 0.01
   };

   let time = 0;
   let loop = function () {
    let n = -Math.cos(time);
    pulse((1 + n) * .5, (1 + n) * .5);
    time += ((Math.sin(time)) < 0 ? 9 : (n > 0.8) ? .2 : 1) * config.timeDelta;
    ctx.fillStyle = "rgba(0,0,0,.1)";
    ctx.fillRect(0, 0, width, height);
    for (i = e.length; i--;) {
     var u = e[i];
     var q = targetPoints[u.q];
     var dx = u.trace[0].x - q[0];
     var dy = u.trace[0].y - q[1];
     var length = Math.sqrt(dx * dx + dy * dy);
     if (10 > length) {
      if (0.95 < rand()) {
       u.q = ~~(rand() * heartPointsCount);
      } else {
       if (0.99 < rand()) {
        u.D *= -1;
       }
       u.q += u.D;
       u.q %= heartPointsCount;
       if (0 > u.q) {
        u.q += heartPointsCount;
       }
      }
     }
     u.vx += -dx / length * u.speed;
     u.vy += -dy / length * u.speed;
     u.trace[0].x += u.vx;
     u.trace[0].y += u.vy;
     u.vx *= u.force;
     u.vy *= u.force;
     for (k = 0; k < u.trace.length - 1;) {
      let T = u.trace[k];
      let N = u.trace[++k];
      N.x -= config.traceK * (N.x - T.x);
      N.y -= config.traceK * (N.y - T.y);
     }
     ctx.fillStyle = u.f;
     for (k = 0; k < u.trace.length; k++) {
      ctx.fillRect(u.trace[k].x, u.trace[k].y, 1, 1);
     }
    }
    ctx.fillStyle = "rgba(255,255,255,1)";
    for (i = u.trace.length + 13; i--;) ctx.fillRect(targetPoints[i][0], targetPoints[i][1], 2, 2);

    window.requestAnimationFrame(loop, canvas);
   };
   loop();
  };

  let s = document.readyState;
  if (s === 'complete' || s === 'loaded' || s === 'interactive') init();
  else document.addEventListener('DOMContentLoaded', init, false);
 </script>

<div class="reset">
    <center>
    <button id="back" onclick="history.back()" style:color="black";background-color:#e60073>Cofnij</button>
    <button id="reset" onclick="window.location.href='valentine-confession.html'">List ‚ù§Ô∏è</button>
    </center>
</div>

</body>
</html>
